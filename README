#!/bin/bash


dir="/data/agentdaemon"

ip=`ifconfig eth0|grep -w inet|awk '{print $2}'`

hostname=`hostname`

cmd="export isProxy=false;export hostip=10.68.238.224:18084;export token=MTEwQDI=;export version=djEuMS4z;export agentIds=ZG9jYw==;export configIds=ZDQzODEzNDU2MWNhYjlhZmRmNTkwMDQ4ZDQ0ODJiYTM=;export tagIds=;export isNeedAdministrator=ZmFsc2U=;([[ 1 != `command -v curl ||  echo $?` ]]  &&  (curl http://$hostip/api/ext/gaia/daemon/sh | bash))  || ([[ 1 != `command -v wget ||  echo $?` ]] &&   (wget -O doccsh_wget.sh http://$hostip/api/ext/gaia/daemon/wgetsh && chmod u+x doccsh_wget.sh && bash doccsh_wget.sh))   || (curl http://$hostip/api/ext/gaia/daemon/wgetsh | bash )"

 if [ ! -d "/data" ];then

    echo "/data目录不存在，正在创建"

    mkdir /data

else

    echo "/data目录存在，不创建"

fi



 if [ ! -d "$dir" ];then

    echo "/data/agentdaemon目录不存在,正在安装......"
   cd /data
    echo ${cmd}|awk '{run=$0;system(run)}'

  echo "安装已完成."

else

  echo "/data/agentdaemon目录存在,服务已安装"


fi


echo "$hostname$ip">/data/agentdaemon/meta/.daemonid

